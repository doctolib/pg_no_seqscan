-- Test view detection
-- Setup
LOAD 'pg_no_seqscan';
SET pg_no_seqscan.level = ERROR;
CREATE TABLE test_view_table AS (SELECT * FROM generate_series(1,10) as id);
CREATE VIEW test_view AS SELECT * FROM test_view_table;
-- Blocks query execution as a seqscan is done on the table behind the view
EXPLAIN (COSTS OFF)
SELECT * FROM test_view;
         QUERY PLAN          
-----------------------------
 Seq Scan on test_view_table
(1 row)

SELECT * FROM test_view;
ERROR:  A 'Sequential Scan' has been detected:

  - Tables involved:

  test_view_table

  - Query:

  SELECT * FROM test_view;

  - Query plan:

  Seq Scan on test_view_table


Make sure the query is compatible with the existing indexes.

-- Cleanup
DROP VIEW test_view;
DROP TABLE test_view_table;
